{% extends "layout.html" %}

{% block title %}Keskustelu {% if other_user.display_name %}{{ other_user.display_name }}{% else %}{{ other_user.username }}{% endif %}{% endblock %}

{% block content %}
<h2>Viestit käyttäjän {% if other_user.display_name %}{{ other_user.display_name }} ({{ other_user.username }}){% else %}{{ other_user.username }}{% endif %} kanssa</h2>
<nav aria-label="Navigointi">
  <p><a href="/messages">← Takaisin</a></p>
</nav>

<section aria-labelledby="messages-heading">
  <h3 id="messages-heading">Viestit</h3>
  {% for m in messages %}
    <article class="message">
      <header>
        <span class="sender">{% if m.sender_display_name %}{{ m.sender_display_name }} ({{ m.sender }}){% else %}{{ m.sender }}{% endif %}</span>
        <span class="timestamp">{{ m.created_at }}</span>
      </header>
      <div class="content">{{ m.body | show_lines }}</div>
    </article>
  {% endfor %}
</section>

<section aria-labelledby="reply-form-heading">
  <h3 id="reply-form-heading">Vastaa</h3>
  <form action="/messages/{{ thread_id }}" method="post">
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}" />
    <p>
      <label for="body">Viesti:</label><br>
      <textarea id="body" name="body" rows="4" cols="60"></textarea>
    </p>
    <input type="submit" value="Lähetä">
  </form>
</section>
{% endblock %}
