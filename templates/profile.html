{% extends "layout.html" %}

{% block title %}Profiili - Coachfinder{% endblock %}

{% block content %}
<h2>Oma profiili</h2>

{% if session.username %}
<div class="profile-info">
  {% if user.has_image %}
  <img src="/image/{{ user.id }}" class="profile-image" />
  <p>
    <a href="/add_image">Muuta kuvaa</a> |
    <a href="/confirm_delete_image">Poista kuva</a>
  </p>
  {% else %}
  <p><em>Ei profiilikuvia</em> | <a href="/add_image">Lisää profiilikuva</a></p>
  {% endif %}
</div>

<form method="POST">
  <p>
    <label for="display_name">Näyttönimi:</label><br>
    <input type="text" id="display_name" name="display_name" value="{{ current_display_name or '' }}" placeholder="Syötä nimesi" maxlength="100">
  </p>
  <p>
    <small>Tämä nimi näkyy ilmoituksissasi.</small>
  </p>
  <p>
    <input type="submit" value="Tallenna">
  </p>
</form>

<div class="profile-info">
  <p><strong>Käyttäjätunnus:</strong> {{ session.username }}</p>
  {% if current_display_name %}
  <p><strong>Nykyinen näyttönimi:</strong> {{ current_display_name }}</p>
  {% else %}
  <p><em>Ei näyttönimeä asetettu</em></p>
  {% endif %}
</div>

<h3>Ilmoitukseni</h3>
{% if announcements %}
  {% set announcement_count = announcements|length %}
  {% if announcement_count == 1 %}
    <p>Sinulla on {{ announcement_count }} ilmoitus.</p>
  {% else %}
    <p>Sinulla on {{ announcement_count }} ilmoitusta.</p>
  {% endif %}
  {% for announcement in announcements %}
    <div class="announcement">
      <h3><a href="/announcement/{{ announcement.id }}">{{ announcement.sport }}</a></h3>
      <p><strong>Kaupunki:</strong> {{ announcement.city }}</p>
      <p><strong>Ikäryhmä:</strong> {{ announcement.age_group }}</p>
      <p><strong>Taitotaso:</strong> {{ announcement.skill_level }}</p>
      <div class="description">
        <strong>Kuvaus:</strong> {{ announcement.description }}
      </div>
    </div>
  {% endfor %}
{% else %}
  <p>Sinulla ei ole vielä ilmoituksia.</p>
{% endif %}

{% else %}
<p>Sinun täytyy kirjautua sisään nähdäksesi profiilin.</p>
{% endif %}
{% endblock %}