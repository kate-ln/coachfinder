{% extends "layout.html" %}

{% block title %}{% if user.display_name %}{{ user.display_name }}{% else %}{{ user.username }}{% endif %} - Profiili{% endblock %}

{% block content %}
<h2>{% if user.display_name %}{{ user.display_name }}{% else %}{{ user.username }}{% endif %}</h2>

<section class="profile-info" aria-labelledby="profile-heading">
  <h3 id="profile-heading">Profiilitiedot</h3>
  {% if user.has_image %}
  <img src="/image/{{ user.id }}" class="profile-image" alt="Käyttäjän {{ user.username }} kuva" />
  {% endif %}
  <p><strong>Käyttäjätunnus:</strong> {{ user.username }}</p>
  {% if user.display_name %}
  <p><strong>Nimi:</strong> {{ user.display_name }}</p>
  {% endif %}
</section>

<section aria-labelledby="user-announcements-heading">
  <h3 id="user-announcements-heading">Ilmoitukset</h3>
  {% set total_announcements = (student_announcements|length) + (coach_announcements|length) %}
  {% if total_announcements > 0 %}
    {% if total_announcements == 1 %}
      <p>Käyttäjällä on {{ total_announcements }} ilmoitus.</p>
    {% else %}
      <p>Käyttäjällä on {{ total_announcements }} ilmoitusta.</p>
    {% endif %}
    
    {% if student_announcements %}
    <h4>Oppilasilmoitukset (Etsin valmentajaa)</h4>
    {% for announcement in student_announcements %}
      <article class="announcement">
        <h5><a href="/announcement/{{ announcement.id }}">{{ announcement.sport }}</a>{% if announcement.found %} <span style="background-color: #28a745; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; margin-left: 8px;">Valmentaja löydetty</span>{% endif %}</h5>
        <p><strong>Kaupunki:</strong> {{ announcement.city }}</p>
        <p><strong>Ikäryhmä:</strong> {{ announcement.age_group }}</p>
        <p><strong>Taitotaso:</strong> {{ announcement.skill_level }}</p>
        <div class="description"><strong>Kuvaus:</strong> {{ announcement.description.strip() }}</div>
      </article>
    {% endfor %}
    {% endif %}
    
    {% if coach_announcements %}
    <h4>Valmentajailmoitukset (Etsin valmennettavaa)</h4>
    {% for announcement in coach_announcements %}
      <article class="announcement">
        <h5><a href="/announcement_coach/{{ announcement.id }}">{{ announcement.sport }}</a>{% if announcement.found %} <span style="background-color: #28a745; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; margin-left: 8px;">Valmennettavat löydetty</span>{% endif %}</h5>
        <p><strong>Kaupunki:</strong> {{ announcement.city }}</p>
        <p><strong>Kokemus:</strong> {{ announcement.experience_level }}</p>
        <div class="description"><strong>Kuvaus:</strong> {{ announcement.description.strip() }}</div>
      </article>
    {% endfor %}
    {% endif %}
  {% else %}
    <p>Käyttäjällä ei ole vielä ilmoituksia.</p>
  {% endif %}
</section>

<p><a href="/">Takaisin etusivulle</a></p>
{% endblock %}
