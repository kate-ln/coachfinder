{% extends "layout.html" %}

{% block title %}Oppilasilmoitus{% endblock %}

{% block content %}
<h2>Oppilasilmoitus</h2>

{% if not session.user_id %}
<section aria-labelledby="login-prompt-heading">
  <h3 id="login-prompt-heading">Kirjautuminen vaaditaan</h3>
  <p>
    Kirjaudu sisään <a href="/login?next_page={{ request.url }}">tästä</a> nähdäksesi käyttäjän {% if announcement.display_name %}{{ announcement.display_name }}{% else %}{{ announcement.username }}{% endif %} tiedot.
  </p>
</section>
{% endif %}

{% if session.user_id == announcement.user_id %}
<nav aria-label="Ilmoituksen toiminnot">
  <p>
    <a href="/edit_announcement/{{ announcement.id }}">Muokkaa</a> |
    <a href="/remove_announcement/{{ announcement.id }}">Poista</a>
    {% if announcement.found %}
    | <form method="post" action="/mark_announcement_not_found/{{ announcement.id }}" style="display: inline; margin: 0; padding: 0;">
        <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
        <button type="submit" style="background: none; border: none; color: #0066cc; text-decoration: underline; cursor: pointer; padding: 0; font-size: inherit; margin: 0;">Poista "Löydetty" -merkintä</button>
      </form>
    {% else %}
    | <form method="post" action="/mark_announcement_found/{{ announcement.id }}" style="display: inline; margin: 0; padding: 0;">
        <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
        <button type="submit" style="background: none; border: none; color: #0066cc; text-decoration: underline; cursor: pointer; padding: 0; font-size: inherit; margin: 0;">Valmentaja löydetty</button>
      </form>
    {% endif %}
  </p>
</nav>
{% endif %}

<article class="announcement" aria-labelledby="announcement-details-heading">
  <h3 id="announcement-details-heading">Ilmoituksen tiedot</h3>
  <p><strong>Nimi:</strong> <a href="/profile/{{ announcement.user_id }}">{% if announcement.display_name %}{{ announcement.display_name }} ({{ announcement.username }}){% else %}{{ announcement.username }}{% endif %}</a></p>
  <p><strong>Laji:</strong> {{ announcement.sport }}{% if announcement.found %} <span style="background-color: #28a745; color: white; padding: 2px 6px; border-radius: 3px; font-size: 0.8em; margin-left: 8px;">Valmentaja löydetty</span>{% endif %}</p>
  <p><strong>Paikkakunta:</strong> {{ announcement.city }}</p>
  {% if announcement.classes %}
  {% for class in announcement.classes %}
  <p><strong>{{ class.title }}:</strong> {{ class.value }}</p>
  {% endfor %}
  {% endif %}
  <div class="description"><strong>Kuvaus:</strong> {{ announcement.description.strip() }}</div>
</article>
{% endblock %}
 